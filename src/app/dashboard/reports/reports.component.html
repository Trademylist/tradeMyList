<section class="section-container">
    <div class="content-wrapper">
        <div class="content-heading">
            <div class="row">
                <div class="col-lg-12">
                    <strong>
                        Manage Reports
                    </strong>
                </div>
            </div>
        </div>

        <div class="mb-1 alert alert-success" role="alert" *ngIf="successDiv">{{message}}
            <button type="button" class="cus-msg-close-btn" (click)="closeMessageDiv()">X</button>
        </div>
        <div class="mb-1 alert alert-danger" role="alert" *ngIf="errorDiv">{{message}}
            <button type="button" class="cus-msg-close-btn" (click)="closeMessageDiv()">X</button>
        </div>

        <div class="row" *ngIf="reportListDiv">
            <div class="col-lg-12">
                <div class="form-group">
                    <label>Search Reports</label>
                    <input class="form-control" type="text" [(ngModel)]="searchInput" placeholder="Search by report">
                </div>
            </div>

            <div class="col-lg-12 table-responsive text-black">
                <table id="example" class="table table-striped table-hover cus-nowrap">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Comment</th>
                            <th>Sub Comment</th>
                            <th>Created Date</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr
                            *ngFor="let getReport of allReports | searchFilter:searchInput | paginate: { itemsPerPage: 5, currentPage: p }; index as i">
                            <td>{{ getIndex(i) }}</td>
                            <td>{{getReport?.comment}}</td>
                            <td>{{getReport?.sub_comment}}</td>
                            <td>{{getReport?.createdAt | date}}</td>
                            <td>{{getReport?.status}}</td>
                            <td>
                                <span class="badge badge-success mr-2" style="cursor:pointer;"
                                    (click)="startEdit(getReport)">
                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                </span>
                                <span class="badge badge-danger" style="cursor:pointer;"
                                    (click)="startDelete(getReport)">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <tfoot>
                    <tr>
                        <pagination-controls (pageChange)="p = $event"></pagination-controls>
                    </tr>
                </tfoot>
            </div>
        </div>

        <div class="row" *ngIf="isEditDiv">
            <div class="col-lg-12 mb-2" style="border-bottom: 1px solid gray;">
                <h4 (click)="closeEdit()">
                    <i class="fa fa-arrow-left mr-2" aria-hidden="true"></i> Report Details</h4>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label>Comment</label>
                    <p>{{userReportDtls?.comment}}</p>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label>Sub Comment</label>
                    <p>{{userReportDtls?.sub_comment}}</p>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>Report User Details</label>
                    <div class="row">
                        <div class="col-lg-12">
                            <table id="example" class="table table-striped table-hover cus-nowrap">
                                <thead>
                                    <tr>
                                        <th>Email</th>
                                        <th>Email Verify</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Action(Block / Unblock User)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{reportedUserDtls?.email}}</td>
                                        <td>{{reportedUserDtls?.email_verify}}</td>
                                        <td>{{reportedUserDtls?.role}}</td>
                                        <td *ngIf="reportedUserDtls?.status == 'Active'">
                                            <span class="badge badge-success">Active</span>
                                        </td>
                                        <td *ngIf="reportedUserDtls?.status == 'In Active'">
                                            <span class="badge badge-danger">In Active</span>
                                        </td>
                                        <td>
                                            <select class="form-control" name="status" [(ngModel)]="reportedUserDtls.status"
                                                (change)="blockUser()">
                                                <option value="Active">Active</option>
                                                <option value="In Active">In Active</option>
                                            </select>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>Report By Users</label>
                    <table id="example" class="table table-striped table-hover cus-nowrap">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Email</th>
                                <th>Email Verify</th>
                                <th>Role</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr
                                *ngFor="let reportBy of reportedByUserDtls | paginate: { itemsPerPage: 5, currentPage: p }; index as i">
                                <td>{{i+1}}</td>
                                <td>{{reportBy?.email}}</td>
                                <td>{{reportBy?.email_verify}}</td>
                                <td>{{reportBy?.role}}</td>
                                <td>{{reportBy?.status}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
    </div>
</section>